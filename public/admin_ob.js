var help=new function(){this.on=false;this.speed=500;var a=this;this.init=function(){if($("#help #help_inner").css("display")=="block"){a.on=true}};this.continueToggle=function(){if(!a.on){$("#help #help_inner").slideDown(a.speed,a.contentIn)}else{a.contentOut()}};this.toggle=function(){$.ajax({url:"http://"+WEB_ROOT+PUBLIC_DIR+"/admin/toggle_help",timeout:5000,type:"GET",dataType:"json",success:function(b,c){a.continueToggle()},error:function(c,b,d){alert(b)}})};this.contentIn=function(){$("#help #help_inner div").fadeTo(a.speed/3,1,function(){a.on=true})};this.contentOut=function(){$("#help #help_inner div").fadeTo(a.speed/3,0,a.hideHelp)};this.hideHelp=function(){$("#help #help_inner").slideUp(a.speed,function(){a.on=false})}};var toggle=function(c){var b=c.parent();var a=b.find("> img");c.empty();var d=b.find("> ul");if(d.css("display")=="none"){d.removeClass();c.append("-");if(!/data/.test(a.attr("src"))){a.attr("src","http://"+WEB_ROOT+PUBLIC_DIR+"/elib/t_folder_open.gif")}}else{d.addClass("hidden_sections");c.append("+");if(!/data/.test(a.attr("src"))){a.attr("src","http://"+WEB_ROOT+PUBLIC_DIR+"/elib/t_folder_closed.gif")}}};var properties=function(){$("#image_sizes form span.edit_box").bind("click",function(d){var c=$(this);if(edit_box.locked==0){var a=c.attr("id").split("_");var f=a[1];var b=a[0];edit_box.init(c.parent(),c.text(),f,b);edit_box.enter()}})};var edit_box=new function(){this.current_text="";this.old_text="";this.parent_element;this.locked=0;this.id=0;this.field="";var a=this;this.init=function(d,b,e,c){a.parent_element=d;a.current_text=b;a.old_text=a.current_text;a.id=e;a.field=c};this.error=function(b){alert(b);a.current_text=a.old_text;a.leave()};this.enter=function(){a.locked=1;a.parent_element.empty().append('<input type="text" id="'+a.field+"_"+a.id+'" value="'+a.current_text+'" />');var b=a.parent_element.find("input");b.focus();b.bind("blur",function(d){var c=$(this);a.current_text=c.attr("value");if(a.current_text==a.old_text){a.leave()}else{$.ajax({url:window.location.toString(),timeout:5000,type:"POST",dataType:"json",data:"field="+a.field+"&id="+a.id+"&value="+a.current_text,success:function(e,f){if(e==1){a.error("server error")}else{if(e==2){a.error("invalid option value")}else{a.leave()}}},error:function(g,f,h){a.error(f)}})}})};this.leave=function(){a.locked=0;a.parent_element.empty().append('<span class="option" id="'+a.field+"_"+a.id+'">'+a.current_text+"</span>");var b=a.parent_element.find("span");b.bind("click",function(d){var c=$(this);if(a.locked==0){a.init(c.parent(),c.text(),c.attr("id").split("_")[1]);a.enter()}})}};var tree=function(){$("ul#tree li a.toggle, ul#tree ul li a.toggle").bind("click",function(b){b.preventDefault();var a=$(this);toggle(a)})};var radios=function(){$(".radios input[name='data_type']").change(function(){if($(".radios input")[4].checked){$("#containers").removeClass("hidden")}else{$("#containers").addClass("hidden")}})};$(document).ready(function(){if($("ul#tree").length>0){tree()}if($(".radios").length>0){radios()}if($("#image_sizes").length>0){properties()}$("a.confirm").bind("click",function(a){return confirm("Are you sure you want to do this?")});$("form.confirm").submit(function(){return confirm("Are you sure you want to do this?")});if($("#help").length>0){help.init();$("#help_tab").bind("click",function(a){a.preventDefault();help.toggle()})}tinyMCE.init({mode:"textareas",theme:"advanced",theme_advanced_buttons1:"formatselect,bold,italic,link,unlink,code",theme_advanced_buttons2:"",theme_advanced_blockformats:"p,h2,h3,h4",theme_advanced_toolbar_location:"top",plugins:"paste,inlinepopups",paste_remove_styles:true,paste_preprocess:function(a,b){b.content=b.content.replace(/(<([^>]+)>)/gi,"")}})});